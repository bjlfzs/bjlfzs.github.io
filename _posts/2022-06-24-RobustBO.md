---
title: 非负矩阵分解算法
author: theq Yang
date: 2022-02-13 13:00:00 +0800
categories: [Blogging, Algorithm]
tags: [NMF]
math: true
mermaid: true
---

## NMF算法


论文链接：https://arxiv.org/pdf/2202.07549.pdf

项目链接：https://github.com/facebookresearch/robust_mobo

本文是facebook组新中ICML2022的一篇工作，其在理论角度上对有输入噪声的多物体贝叶斯优化进行了分析。

<h3 data-toc-skip>引言</h3>
本文章面向多目标优化的输入噪声问题，结合贝叶斯优化和帕累托最优的思想设计了一个全局多目标风险价值，以解决对输入噪声敏感的黑箱约束的问题。
贝叶斯优化通过调整设计参数，可以优化高评估成本的黑箱性能指标。虽然现有很多方法被提出用于在输入噪声下优化单一目标，但仍然缺少能够解决存在多个目标对输入扰动敏感的实际情况的方法。在这项工作中，作者提出了第一个鲁棒的多目标贝叶斯优化方法以应对输入噪声。我们将我们的目标形式化为优化多变量风险值(MVAR)，这是一种不确定目标的风险度量。由于直接优化MVAR在许多情况下在计算上是不可行的，我们提出了一种可扩展的、基于理论的方法来使用随机尺度来优化MVAR。实验上而言，该方法在数据集上显著优于其他方法，并有效地实现了最优鲁棒设计。

图1：左：非鲁棒设计（紫色$x_1$）和鲁棒设计（绿色$x_2$）的标称值使用正方形表示。加号标记表示每个设计在零均值高斯输入噪声下的目标值，标准差为0.1。可以看到，虽然非鲁棒设计可能会获得较大的结果，但是其在输入扰动下的不稳定，容易获得更坏的表现。
中：非鲁棒和鲁棒设计的MVAR集的说明。三角形表示在输入噪声分布下，每个设计的MVAR集的离散近似。在没有考虑噪声的情况下，紫色$x_1$正方形可以对应更好的值；但是在加以扰动后其风险(MVAR)较大，难以做到对于输入噪声的鲁棒。所以可以采用多变量风险值来刻画解的稳定性。
右：在三个目标上的MVAR集合，其中风险的最优集是不同目标MVAR集的并集上的最优点集。

<h4 data-toc-skip>背景</h4>

帕累托边界：
帕累托最优(Pareto optimality)是一种不能再改进的状态，不可能再改善某些个体或偏好准则而不使任何其他个体或准则受损。
如果一种状态存在帕累托改进，那么它被称作受帕累托支配的。一种状态如果是不受帕累托支配的，那么它被称作帕累托最优的或帕累托有效的，在优化问题中可以看作是最优点。这样的最优点组成的集合被称为帕累托边界。


图2：这里给出帕累托边界的一个例子。集合中的点表示可行的选择，这里认为更小的值是更优的，红线代表帕累托边界，其上面的样本点均是帕累托有效的。点C同时被点A和点B支配，所以其不在帕累托边界上。点A和点B不受任何其他点严格控制，因此位于边界上。


多目标优化：
考虑最大化黑盒函数：$\max_{x\in \mathbf{X}} f(x)$ where $f(x) := [f_1(x), . . . , f_M(x)]$, 
$M \geq 2$是目标个数，$X \in R^d$是紧搜索空间。又上述定义可以引出帕累托支配和帕累托边界的定义。
<!-- 这里给出一些定义： -->
向量 $f(x)$ 帕累托支配于 $f(x_0)$，记作$f(x) \succ f(x_0)$，当且仅当$f(x) \geq f(x_0)$ and $\exist j \in {1, \dots , M}$ 满足$f^{(j)}(x) > f^{(j)}(x_0)$. 

这里定义$F = {f(x) | x \in X \subseteq \mathbf{X}}$的帕累托边界：$PARETO(F) = {f(x) \in F :	\nexists x_0 \in \mathbf{X} s.t. f(x_0 ) \succ f(x)}$，若PARETO中的元素均满足附加约束$c(x) \geq 0$，则将相应的最优设计集称为帕累托集。而后，作者通过定义测度(hypervolume和hypervolume improvement)来衡量不同帕累托边界的质量。

<h4 data-toc-skip>方法</h4>

在这里首先要对于风险进行定义：期望风险测量可能并不总是与真正鲁棒性目标相一致，所以在这里采用概率风险进行分析，并得到以下定义：

定义1给出了风险价值的定义，其得到了在噪声中$f$的一个下界$z$，使得$f$的结果有不小于$\alpha$的概率大于$z$中，依此来刻画分布。

而对于Multivariate Value-At-Risk(MVAR)而言，作者设计其是不同目标的帕累托边界，

本文通过引入切比雪夫尺度化展示了VaR和MVaR间的关系，并可以对MVaR set进行估计。
这里图3是对图1简易数据的MVaR集合构建的过程，其中左图中黑点表示对于标准差为0.1的零均值为0的高斯输入扰动的函数值，背景是一个显示跨越目标空间的切比雪夫尺度化值的轮廓。中间的图给出了切比雪夫尺度化的概率密度和α=0.9的切比雪夫尺度化的风险值v，黑线右侧的概率质量等于α。右图展示了通过文中所证明的定理构建出的关系，将VaR映射到MVaR中，绿色三角形代表了来自输入噪声分布的MVAR集的离散近似。
<h4 data-toc-skip>总结与思

左：对于标准差为0.1的零均值为0的高斯输入扰动的单个设计的函数值，用黑点标记。背景是一个显示跨越目标空间的切比雪夫尺度化值的轮廓。中心：切比雪夫尺度化的概率密度和α=0.9的切比雪夫尺度化的风险值v。黑线右侧的概率质量等于α。右：利用定理5.1，VAR，w可以映射到MVAR集中的点，该点在90%的输入扰动下由目标主导。绿色三角形代表了来自输入噪声分布的64个样本的MVAR集的离散近似。绿色区域表示主导已识别的MVAR点的区域，或者，等价地，由w定义的切比雪夫尺度化大于v的区域。考</h4>

在这篇工作中，作者结合了贝叶斯优化和多目标融合的性质，从分布层面来对于输入噪声进行了分析，其通过设计NVAR风险和寻找多目标风险的帕累托最优，很好的结合了两个方法的特点，思路较为简单合理。对于其他的多源目标的优化，比如多模态、多视角、多任务学习而言，该方法指导我们可以从数据扰动风险的角度入手，来分析方法中潜在的输入噪声问题。

同时，虽然方法简单而直接，作者仅仅用了小篇幅就对于方法实现了阐述，而通过大量的铺垫清晰阐述文章的背景和主要贡献，并在附录中给出了大量的证明说明了其中引理的正确性。同时，作者仅通过两幅图像即说明主要的问题和方法，清晰的展示出了多目标情境下的鲁棒性问题。



